/*!
* Viewer v1.0.0
* https://github.com/fengyuanchen/viewer
*
* Copyright (c) 2015-2018 Chen Fengyuan
* Released under the MIT license
*
* Date: 2018-04-01T06:09:55.194Z
*/
(function(global,factory){typeof exports==='object'&&typeof module!=='undefined'?factory(require('jquery')):typeof define==='function'&&define.amd?define(['jquery'],factory):(factory(global.jQuery))}(this,(function($){'use strict';$=$&&$.hasOwnProperty('default')?$['default']:$;var DEFAULTS={inline:!1,button:!0,navbar:!0,title:!0,toolbar:!0,tooltip:!0,movable:!0,zoomable:!0,rotatable:!0,scalable:!0,transition:!0,fullscreen:!0,interval:5000,keyboard:!0,backdrop:!0,loading:!0,loop:!0,minWidth:200,minHeight:100,zoomRatio:0.1,minZoomRatio:0.01,maxZoomRatio:100,zIndex:2015,zIndexInline:0,url:'src',container:'body',filter:null,ready:null,show:null,shown:null,hide:null,hidden:null,view:null,viewed:null};var TEMPLATE='<div class="viewer-container" touch-action="none">'+'<div class="viewer-canvas"></div>'+'<div class="viewer-footer">'+'<div class="viewer-title"></div>'+'<div class="viewer-toolbar"></div>'+'<div class="viewer-navbar">'+'<ul class="viewer-list"></ul>'+'</div>'+'</div>'+'<div class="viewer-tooltip"></div>'+'<div role="button" class="viewer-button" data-action="mix"></div>'+'<div class="viewer-player"></div>'+'</div>';var IN_BROWSER=typeof window!=='undefined';var WINDOW=IN_BROWSER?window:{};var NAMESPACE='viewer';var ACTION_MOVE='move';var ACTION_SWITCH='switch';var ACTION_ZOOM='zoom';var CLASS_ACTIVE=NAMESPACE+'-active';var CLASS_CLOSE=NAMESPACE+'-close';var CLASS_FADE=NAMESPACE+'-fade';var CLASS_FIXED=NAMESPACE+'-fixed';var CLASS_FULLSCREEN=NAMESPACE+'-fullscreen';var CLASS_FULLSCREEN_EXIT=NAMESPACE+'-fullscreen-exit';var CLASS_HIDE=NAMESPACE+'-hide';var CLASS_HIDE_MD_DOWN=NAMESPACE+'-hide-md-down';var CLASS_HIDE_SM_DOWN=NAMESPACE+'-hide-sm-down';var CLASS_HIDE_XS_DOWN=NAMESPACE+'-hide-xs-down';var CLASS_IN=NAMESPACE+'-in';var CLASS_INVISIBLE=NAMESPACE+'-invisible';var CLASS_LOADING=NAMESPACE+'-loading';var CLASS_MOVE=NAMESPACE+'-move';var CLASS_OPEN=NAMESPACE+'-open';var CLASS_SHOW=NAMESPACE+'-show';var CLASS_TRANSITION=NAMESPACE+'-transition';var EVENT_READY='ready';var EVENT_SHOW='show';var EVENT_SHOWN='shown';var EVENT_HIDE='hide';var EVENT_HIDDEN='hidden';var EVENT_VIEW='view';var EVENT_VIEWED='viewed';var EVENT_CLICK='click';var EVENT_DRAG_START='dragstart';var EVENT_KEY_DOWN='keydown';var EVENT_LOAD='load';var EVENT_POINTER_DOWN=WINDOW.PointerEvent?'pointerdown':'touchstart mousedown';var EVENT_POINTER_MOVE=WINDOW.PointerEvent?'pointermove':'touchmove mousemove';var EVENT_POINTER_UP=WINDOW.PointerEvent?'pointerup pointercancel':'touchend touchcancel mouseup';var EVENT_RESIZE='resize';var EVENT_TRANSITION_END='transitionend';var EVENT_WHEEL='wheel mousewheel DOMMouseScroll';var BUTTONS=['zoom-in','zoom-out','one-to-one','reset','prev','play','next','rotate-left','rotate-right','flip-horizontal','flip-vertical'];var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};var classCallCheck=function(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}};var createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}
return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function isString(value){return typeof value==='string'}
var isNaN=Number.isNaN||WINDOW.isNaN;function isNumber(value){return typeof value==='number'&&!isNaN(value)}
function isUndefined(value){return typeof value==='undefined'}
function isObject(value){return(typeof value==='undefined'?'undefined':_typeof(value))==='object'&&value!==null}
var hasOwnProperty=Object.prototype.hasOwnProperty;function isPlainObject(value){if(!isObject(value)){return!1}
try{var _constructor=value.constructor;var prototype=_constructor.prototype;return _constructor&&prototype&&hasOwnProperty.call(prototype,'isPrototypeOf')}catch(e){return!1}}
function isFunction(value){return typeof value==='function'}
function forEach(data,callback){if(data&&isFunction(callback)){if(Array.isArray(data)||isNumber(data.length)){var length=data.length;var i=void 0;for(i=0;i<length;i+=1){if(callback.call(data,data[i],i,data)===!1){break}}}else if(isObject(data)){Object.keys(data).forEach(function(key){callback.call(data,data[key],key,data)})}}
return data}
var assign=Object.assign||function assign(obj){for(var _len=arguments.length,args=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key]}
if(isObject(obj)&&args.length>0){args.forEach(function(arg){if(isObject(arg)){Object.keys(arg).forEach(function(key){obj[key]=arg[key]})}})}
return obj};var REGEXP_SUFFIX=/^(?:width|height|left|top|marginLeft|marginTop)$/;function setStyle(element,styles){var style=element.style;forEach(styles,function(value,property){if(REGEXP_SUFFIX.test(property)&&isNumber(value)){value+='px'}
style[property]=value})}
function hasClass(element,value){return element.classList?element.classList.contains(value):element.className.indexOf(value)>-1}
function addClass(element,value){if(!value){return}
if(isNumber(element.length)){forEach(element,function(elem){addClass(elem,value)});return}
if(element.classList){element.classList.add(value);return}
var className=element.className.trim();if(!className){element.className=value}else if(className.indexOf(value)<0){element.className=className+' '+value}}
function removeClass(element,value){if(!value){return}
if(isNumber(element.length)){forEach(element,function(elem){removeClass(elem,value)});return}
if(element.classList){element.classList.remove(value);return}
if(element.className.indexOf(value)>=0){element.className=element.className.replace(value,'')}}
function toggleClass(element,value,added){if(!value){return}
if(isNumber(element.length)){forEach(element,function(elem){toggleClass(elem,value,added)});return}
if(added){addClass(element,value)}else{removeClass(element,value)}}
var REGEXP_HYPHENATE=/([a-z\d])([A-Z])/g;function hyphenate(value){return value.replace(REGEXP_HYPHENATE,'$1-$2').toLowerCase()}
function getData(element,name){if(isObject(element[name])){return element[name]}else if(element.dataset){return element.dataset[name]}
return element.getAttribute('data-'+hyphenate(name))}
function setData(element,name,data){if(isObject(data)){element[name]=data}else if(element.dataset){element.dataset[name]=data}else{element.setAttribute('data-'+hyphenate(name),data)}}
function removeData(element,name){if(isObject(element[name])){try{delete element[name]}catch(e){element[name]=undefined}}else if(element.dataset){try{delete element.dataset[name]}catch(e){element.dataset[name]=undefined}}else{element.removeAttribute('data-'+hyphenate(name))}}
var REGEXP_SPACES=/\s\s*/;var onceSupported=function(){var supported=!1;if(IN_BROWSER){var once=!1;var listener=function listener(){};var options=Object.defineProperty({},'once',{get:function get$$1(){supported=!0;return once},set:function set$$1(value){once=value}});WINDOW.addEventListener('test',listener,options);WINDOW.removeEventListener('test',listener,options)}
return supported}();function removeListener(element,type,listener){var options=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var handler=listener;type.trim().split(REGEXP_SPACES).forEach(function(event){if(!onceSupported){var listeners=element.listeners;if(listeners&&listeners[event]&&listeners[event][listener]){handler=listeners[event][listener];delete listeners[event][listener];if(Object.keys(listeners[event]).length===0){delete listeners[event]}
if(Object.keys(listeners).length===0){delete element.listeners}}}
element.removeEventListener(event,handler,options)})}
function addListener(element,type,listener){var options=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var _handler=listener;type.trim().split(REGEXP_SPACES).forEach(function(event){if(options.once&&!onceSupported){var _element$listeners=element.listeners,listeners=_element$listeners===undefined?{}:_element$listeners;_handler=function handler(){for(var _len2=arguments.length,args=Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}
delete listeners[event][listener];element.removeEventListener(event,_handler,options);listener.apply(element,args)};if(!listeners[event]){listeners[event]={}}
if(listeners[event][listener]){element.removeEventListener(event,listeners[event][listener],options)}
listeners[event][listener]=_handler;element.listeners=listeners}
element.addEventListener(event,_handler,options)})}
function dispatchEvent(element,type,data){var event=void 0;if(isFunction(Event)&&isFunction(CustomEvent)){event=new CustomEvent(type,{detail:data,bubbles:!0,cancelable:!0})}else{event=document.createEvent('CustomEvent');event.initCustomEvent(type,!0,!0,data)}
return element.dispatchEvent(event)}
function getOffset(element){var box=element.getBoundingClientRect();return{left:box.left+(window.pageXOffset-document.documentElement.clientLeft),top:box.top+(window.pageYOffset-document.documentElement.clientTop)}}
function getTransforms(_ref){var rotate=_ref.rotate,scaleX=_ref.scaleX,scaleY=_ref.scaleY,translateX=_ref.translateX,translateY=_ref.translateY;var values=[];if(isNumber(translateX)&&translateX!==0){values.push('translateX('+translateX+'px)')}
if(isNumber(translateY)&&translateY!==0){values.push('translateY('+translateY+'px)')}
if(isNumber(rotate)&&rotate!==0){values.push('rotate('+rotate+'deg)')}
if(isNumber(scaleX)&&scaleX!==1){values.push('scaleX('+scaleX+')')}
if(isNumber(scaleY)&&scaleY!==1){values.push('scaleY('+scaleY+')')}
var transform=values.length?values.join(' '):'none';return{WebkitTransform:transform,msTransform:transform,transform:transform}}
function getImageNameFromURL(url){return isString(url)?url.replace(/^.*\//,'').replace(/[?&#].*$/,''):''}
var IS_SAFARI=WINDOW.navigator&&/(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i.test(WINDOW.navigator.userAgent);function getImageNaturalSizes(image,callback){var newImage=document.createElement('img');if(image.naturalWidth&&!IS_SAFARI){callback(image.naturalWidth,image.naturalHeight);return newImage}
var body=document.body||document.documentElement;newImage.onload=function(){callback(newImage.width,newImage.height);if(!IS_SAFARI){body.removeChild(newImage)}};newImage.src=image.src;if(!IS_SAFARI){newImage.style.cssText='left:0;'+'max-height:none!important;'+'max-width:none!important;'+'min-height:0!important;'+'min-width:0!important;'+'opacity:0;'+'position:absolute;'+'top:0;'+'z-index:-1;';body.appendChild(newImage)}
return newImage}
function getResponsiveClass(type){switch(type){case 2:return CLASS_HIDE_XS_DOWN;case 3:return CLASS_HIDE_SM_DOWN;case 4:return CLASS_HIDE_MD_DOWN;default:return''}}
function getMaxZoomRatio(pointers){var pointers2=assign({},pointers);var ratios=[];forEach(pointers,function(pointer,pointerId){delete pointers2[pointerId];forEach(pointers2,function(pointer2){var x1=Math.abs(pointer.startX-pointer2.startX);var y1=Math.abs(pointer.startY-pointer2.startY);var x2=Math.abs(pointer.endX-pointer2.endX);var y2=Math.abs(pointer.endY-pointer2.endY);var z1=Math.sqrt(x1*x1+y1*y1);var z2=Math.sqrt(x2*x2+y2*y2);var ratio=(z2-z1)/z1;ratios.push(ratio)})});ratios.sort(function(a,b){return Math.abs(a)<Math.abs(b)});return ratios[0]}
function getPointer(_ref2,endOnly){var pageX=_ref2.pageX,pageY=_ref2.pageY;var end={endX:pageX,endY:pageY};return endOnly?end:assign({startX:pageX,startY:pageY},end)}
function getPointersCenter(pointers){var pageX=0;var pageY=0;var count=0;forEach(pointers,function(_ref3){var startX=_ref3.startX,startY=_ref3.startY;pageX+=startX;pageY+=startY;count+=1});pageX/=count;pageY/=count;return{pageX:pageX,pageY:pageY}}
var render={render:function render(){this.initContainer();this.initViewer();this.initList();this.renderViewer()},initContainer:function initContainer(){this.containerData={width:window.innerWidth,height:window.innerHeight}},initViewer:function initViewer(){var options=this.options,parent=this.parent;var viewerData=void 0;if(options.inline){viewerData={width:Math.max(parent.offsetWidth,options.minWidth),height:Math.max(parent.offsetHeight,options.minHeight)};this.parentData=viewerData}
if(this.fulled||!viewerData){viewerData=this.containerData}
this.viewerData=assign({},viewerData)},renderViewer:function renderViewer(){if(this.options.inline&&!this.fulled){setStyle(this.viewer,this.viewerData)}},initList:function initList(){var _this=this;var element=this.element,options=this.options,list=this.list;var items=[];forEach(this.images,function(image,i){var src=image.src;var alt=image.alt||getImageNameFromURL(src);var url=options.url;if(isString(url)){url=image.getAttribute(url)}else if(isFunction(url)){url=url.call(_this,image)}
if(src||url){items.push('<li>'+'<img'+(' src="'+(src||url)+'"')+' role="button"'+' data-action="view"'+(' data-index="'+i+'"')+(' data-original-url="'+(url||src)+'"')+(' alt="'+alt+'"')+'>'+'</li>')}});list.innerHTML=items.join('');this.items=list.getElementsByTagName('li');forEach(this.items,function(item){var image=item.firstElementChild;setData(image,'filled',!0);if(options.loading){addClass(item,CLASS_LOADING)}
addListener(image,EVENT_LOAD,function(event){if(options.loading){removeClass(item,CLASS_LOADING)}
_this.loadImage(event)},{once:!0})});if(options.transition){addListener(element,EVENT_VIEWED,function(){addClass(list,CLASS_TRANSITION)},{once:!0})}},renderList:function renderList(index){var i=index||this.index;var width=this.items[i].offsetWidth||30;var outerWidth=width+1;setStyle(this.list,assign({width:outerWidth*this.length},getTransforms({translateX:(this.viewerData.width-width)/2-outerWidth*i})))},resetList:function resetList(){var list=this.list;list.innerHTML='';removeClass(list,CLASS_TRANSITION);setStyle(list,getTransforms({translateX:0}))},initImage:function initImage(done){var _this2=this;var options=this.options,image=this.image,viewerData=this.viewerData;var footerHeight=this.footer.offsetHeight;var viewerWidth=viewerData.width;var viewerHeight=Math.max(viewerData.height-footerHeight,footerHeight);var oldImageData=this.imageData||{};var sizingImage=void 0;this.imageInitializing={abort:function abort(){sizingImage.onload=null}};sizingImage=getImageNaturalSizes(image,function(naturalWidth,naturalHeight){var aspectRatio=naturalWidth/naturalHeight;var width=viewerWidth;var height=viewerHeight;_this2.imageInitializing=!1;if(viewerHeight*aspectRatio>viewerWidth){height=viewerWidth/aspectRatio}else{width=viewerHeight*aspectRatio}
width=Math.min(width*0.9,naturalWidth);height=Math.min(height*0.9,naturalHeight);var imageData={naturalWidth:naturalWidth,naturalHeight:naturalHeight,aspectRatio:aspectRatio,ratio:width/naturalWidth,width:width,height:height,left:(viewerWidth-width)/2,top:(viewerHeight-height)/2};var initialImageData=assign({},imageData);if(options.rotatable){imageData.rotate=oldImageData.rotate||0;initialImageData.rotate=0}
if(options.scalable){imageData.scaleX=oldImageData.scaleX||1;imageData.scaleY=oldImageData.scaleY||1;initialImageData.scaleX=1;initialImageData.scaleY=1}
_this2.imageData=imageData;_this2.initialImageData=initialImageData;if(done){done()}})},renderImage:function renderImage(done){var _this3=this;var image=this.image,imageData=this.imageData;setStyle(image,assign({width:imageData.width,height:imageData.height,marginLeft:imageData.left,marginTop:imageData.top},getTransforms(imageData)));if(done){if(this.viewing&&this.options.transition){var onTransitionEnd=function onTransitionEnd(){_this3.imageRendering=!1;done()};this.imageRendering={abort:function abort(){removeListener(image,EVENT_TRANSITION_END,onTransitionEnd)}};addListener(image,EVENT_TRANSITION_END,onTransitionEnd,{once:!0})}else{done()}}},resetImage:function resetImage(){if(this.viewing||this.viewed){var image=this.image;if(this.viewing){this.viewing.abort()}
image.parentNode.removeChild(image);this.image=null}}};var events={bind:function bind(){var element=this.element,viewer=this.viewer;addListener(viewer,EVENT_CLICK,this.onClick=this.click.bind(this));addListener(viewer,EVENT_WHEEL,this.onWheel=this.wheel.bind(this));addListener(viewer,EVENT_DRAG_START,this.onDragStart=this.dragstart.bind(this));addListener(this.canvas,EVENT_POINTER_DOWN,this.onPointerDown=this.pointerdown.bind(this));addListener(element.ownerDocument,EVENT_POINTER_MOVE,this.onPointerMove=this.pointermove.bind(this));addListener(element.ownerDocument,EVENT_POINTER_UP,this.onPointerUp=this.pointerup.bind(this));addListener(element.ownerDocument,EVENT_KEY_DOWN,this.onKeyDown=this.keydown.bind(this));addListener(window,EVENT_RESIZE,this.onResize=this.resize.bind(this))},unbind:function unbind(){var element=this.element,viewer=this.viewer;removeListener(viewer,EVENT_CLICK,this.onClick);removeListener(viewer,EVENT_WHEEL,this.onWheel);removeListener(viewer,EVENT_DRAG_START,this.onDragStart);removeListener(this.canvas,EVENT_POINTER_DOWN,this.onPointerDown);removeListener(element.ownerDocument,EVENT_POINTER_MOVE,this.onPointerMove);removeListener(element.ownerDocument,EVENT_POINTER_UP,this.onPointerUp);removeListener(element.ownerDocument,EVENT_KEY_DOWN,this.onKeyDown);removeListener(window,EVENT_RESIZE,this.onResize)}};var handlers={click:function click(_ref){var target=_ref.target;var options=this.options,imageData=this.imageData;var action=getData(target,'action');switch(action){case 'mix':if(this.played){this.stop()}else if(options.inline){if(this.fulled){this.exit()}else{this.full()}}else{this.hide()}
break;case 'hide':this.hide();break;case 'view':this.view(getData(target,'index'));break;case 'zoom-in':this.zoom(0.1,!0);break;case 'zoom-out':this.zoom(-0.1,!0);break;case 'one-to-one':this.toggle();break;case 'reset':this.reset();break;case 'prev':this.prev(options.loop);break;case 'play':this.play(options.fullscreen);break;case 'next':this.next(options.loop);break;case 'rotate-left':this.rotate(-90);break;case 'rotate-right':this.rotate(90);break;case 'flip-horizontal':this.scaleX(-imageData.scaleX||-1);break;case 'flip-vertical':this.scaleY(-imageData.scaleY||-1);break;default:if(this.played){this.stop()}}},load:function load(){var _this=this;if(this.timeout){clearTimeout(this.timeout);this.timeout=!1}
var element=this.element,options=this.options,image=this.image,index=this.index,viewerData=this.viewerData;removeClass(image,CLASS_INVISIBLE);if(options.loading){removeClass(this.canvas,CLASS_LOADING)}
image.style.cssText='height:0;'+('margin-left:'+viewerData.width/2+'px;')+('margin-top:'+viewerData.height/2+'px;')+'max-width:none!important;'+'position:absolute;'+'width:0;';this.initImage(function(){toggleClass(image,CLASS_MOVE,options.movable);toggleClass(image,CLASS_TRANSITION,options.transition);_this.renderImage(function(){_this.viewed=!0;_this.viewing=!1;if(isFunction(options.viewed)){addListener(element,EVENT_VIEWED,options.viewed,{once:!0})}
dispatchEvent(element,EVENT_VIEWED,{originalImage:_this.images[index],index:index,image:image})})})},loadImage:function loadImage(e){var image=e.target;var parent=image.parentNode;var parentWidth=parent.offsetWidth||30;var parentHeight=parent.offsetHeight||50;var filled=!!getData(image,'filled');getImageNaturalSizes(image,function(naturalWidth,naturalHeight){var aspectRatio=naturalWidth/naturalHeight;var width=parentWidth;var height=parentHeight;if(parentHeight*aspectRatio>parentWidth){if(filled){width=parentHeight*aspectRatio}else{height=parentWidth/aspectRatio}}else if(filled){height=parentWidth/aspectRatio}else{width=parentHeight*aspectRatio}
setStyle(image,assign({width:width,height:height},getTransforms({translateX:(parentWidth-width)/2,translateY:(parentHeight-height)/2})))})},keydown:function keydown(e){var options=this.options;if(!this.fulled||!options.keyboard){return}
switch(e.keyCode||e.which||e.charCode){case 27:if(this.played){this.stop()}else if(options.inline){if(this.fulled){this.exit()}}else{this.hide()}
break;case 32:if(this.played){this.stop()}
break;case 37:this.prev(options.loop);break;case 38:e.preventDefault();this.zoom(options.zoomRatio,!0);break;case 39:this.next(options.loop);break;case 40:e.preventDefault();this.zoom(-options.zoomRatio,!0);break;case 48:case 49:if(e.ctrlKey){e.preventDefault();this.toggle()}
break;default:}},dragstart:function dragstart(e){if(e.target.tagName.toLowerCase()==='img'){e.preventDefault()}},pointerdown:function pointerdown(e){var options=this.options,pointers=this.pointers;if(!this.viewed||this.showing||this.viewing||this.hiding){return}
if(e.changedTouches){forEach(e.changedTouches,function(touch){pointers[touch.identifier]=getPointer(touch)})}else{pointers[e.pointerId||0]=getPointer(e)}
var action=options.movable?ACTION_MOVE:!1;if(Object.keys(pointers).length>1){action=ACTION_ZOOM}else if((e.pointerType==='touch'||e.type==='touchstart')&&this.isSwitchable()){action=ACTION_SWITCH}
this.action=action},pointermove:function pointermove(e){var options=this.options,pointers=this.pointers,action=this.action,image=this.image;if(!this.viewed||!action){return}
e.preventDefault();if(e.changedTouches){forEach(e.changedTouches,function(touch){assign(pointers[touch.identifier],getPointer(touch,!0))})}else{assign(pointers[e.pointerId||0],getPointer(e,!0))}
if(action===ACTION_MOVE&&options.transition&&hasClass(image,CLASS_TRANSITION)){removeClass(image,CLASS_TRANSITION)}
this.change(e)},pointerup:function pointerup(e){var action=this.action,pointers=this.pointers;if(e.changedTouches){forEach(e.changedTouches,function(touch){delete pointers[touch.identifier]})}else{delete pointers[e.pointerId||0]}
if(!action){return}
if(action===ACTION_MOVE&&this.options.transition){addClass(this.image,CLASS_TRANSITION)}
this.action=!1},resize:function resize(){var _this2=this;if(!this.isShown||this.hiding){return}
this.initContainer();this.initViewer();this.renderViewer();this.renderList();if(this.viewed){this.initImage(function(){_this2.renderImage()})}
if(this.played){if(this.options.fullscreen&&this.fulled&&!document.fullscreenElement&&!document.mozFullScreenElement&&!document.webkitFullscreenElement&&!document.msFullscreenElement){this.stop();return}
forEach(this.player.getElementsByTagName('img'),function(image){addListener(image,EVENT_LOAD,_this2.loadImage.bind(_this2),{once:!0});dispatchEvent(image,EVENT_LOAD)})}},wheel:function wheel(e){var _this3=this;if(!this.viewed){return}
e.preventDefault();if(this.wheeling){return}
this.wheeling=!0;setTimeout(function(){_this3.wheeling=!1},50);var ratio=Number(this.options.zoomRatio)||0.1;var delta=1;if(e.deltaY){delta=e.deltaY>0?1:-1}else if(e.wheelDelta){delta=-e.wheelDelta/120}else if(e.detail){delta=e.detail>0?1:-1}
this.zoom(-delta*ratio,!0,e)}};var methods={show:function show(){var immediate=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;var element=this.element,options=this.options;if(options.inline||this.showing||this.isShown||this.showing){return this}
if(!this.ready){this.build();if(this.ready){this.show(immediate)}
return this}
if(isFunction(options.show)){addListener(element,EVENT_SHOW,options.show,{once:!0})}
if(dispatchEvent(element,EVENT_SHOW)===!1||!this.ready){return this}
if(this.hiding){this.transitioning.abort()}
this.showing=!0;this.open();var viewer=this.viewer;removeClass(viewer,CLASS_HIDE);if(options.transition&&!immediate){var shown=this.shown.bind(this);this.transitioning={abort:function abort(){removeListener(viewer,EVENT_TRANSITION_END,shown);removeClass(viewer,CLASS_IN)}};addClass(viewer,CLASS_TRANSITION);viewer.offsetWidth;addListener(viewer,EVENT_TRANSITION_END,shown,{once:!0});addClass(viewer,CLASS_IN)}else{addClass(viewer,CLASS_IN);this.shown()}
return this},hide:function hide(){var immediate=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;var element=this.element,options=this.options;if(options.inline||this.hiding||!(this.isShown||this.showing)){return this}
if(isFunction(options.hide)){addListener(element,EVENT_HIDE,options.hide,{once:!0})}
if(dispatchEvent(element,EVENT_HIDE)===!1){return this}
if(this.showing){this.transitioning.abort()}
this.hiding=!0;if(this.played){this.stop()}else if(this.viewing){this.viewing.abort()}
var viewer=this.viewer;if(options.transition&&!immediate){var hidden=this.hidden.bind(this);var hide=function hide(){addListener(viewer,EVENT_TRANSITION_END,hidden,{once:!0});removeClass(viewer,CLASS_IN)};this.transitioning={abort:function abort(){if(this.viewed){removeListener(this.image,EVENT_TRANSITION_END,hide)}else{removeListener(viewer,EVENT_TRANSITION_END,hidden)}}};if(this.viewed){addListener(this.image,EVENT_TRANSITION_END,hide,{once:!0});this.zoomTo(0,!1,!1,!0)}else{hide()}}else{removeClass(viewer,CLASS_IN);this.hidden()}
return this},view:function view(){var _this=this;var index=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;index=Number(index)||0;if(!this.isShown){this.index=index;return this.show()}
if(this.hiding||this.played||index<0||index>=this.length||this.viewed&&index===this.index){return this}
if(this.viewing){this.viewing.abort()}
var element=this.element,options=this.options,title=this.title,canvas=this.canvas;var item=this.items[index];var img=item.querySelector('img');var url=getData(img,'originalUrl');var alt=img.getAttribute('alt');var image=document.createElement('img');image.src=url;image.alt=alt;if(isFunction(options.view)){addListener(element,EVENT_VIEW,options.view,{once:!0})}
if(dispatchEvent(element,EVENT_VIEW,{originalImage:this.images[index],index:index,image:image})===!1||!this.isShown||this.hiding||this.played){return this}
this.image=image;removeClass(this.items[this.index],CLASS_ACTIVE);addClass(item,CLASS_ACTIVE);this.viewed=!1;this.index=index;this.imageData={};addClass(image,CLASS_INVISIBLE);if(options.loading){addClass(canvas,CLASS_LOADING)}
canvas.innerHTML='';canvas.appendChild(image);this.renderList();title.innerHTML='';var onViewed=function onViewed(){var imageData=_this.imageData;title.textContent=alt+' ('+imageData.naturalWidth+' \xD7 '+imageData.naturalHeight+')'};var onLoad=void 0;addListener(element,EVENT_VIEWED,onViewed,{once:!0});this.viewing={abort:function abort(){removeListener(element,EVENT_VIEWED,onViewed);if(image.complete){if(this.imageRendering){this.imageRendering.abort()}else if(this.imageInitializing){this.imageInitializing.abort()}}else{removeListener(image,EVENT_LOAD,onLoad);if(this.timeout){clearTimeout(this.timeout)}}}};if(image.complete){this.load()}else{addListener(image,EVENT_LOAD,onLoad=this.load.bind(this),{once:!0});if(this.timeout){clearTimeout(this.timeout)}
this.timeout=setTimeout(function(){removeClass(image,CLASS_INVISIBLE);_this.timeout=!1},1000)}
return this},prev:function prev(){var loop=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;var index=this.index-1;if(index<0){index=loop?this.length-1:0}
this.view(index);return this},next:function next(){var loop=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;var maxIndex=this.length-1;var index=this.index+1;if(index>maxIndex){index=loop?0:maxIndex}
this.view(index);return this},move:function move(offsetX,offsetY){var imageData=this.imageData;this.moveTo(isUndefined(offsetX)?offsetX:imageData.left+Number(offsetX),isUndefined(offsetY)?offsetY:imageData.top+Number(offsetY));return this},moveTo:function moveTo(x){var y=arguments.length>1&&arguments[1]!==undefined?arguments[1]:x;var imageData=this.imageData;x=Number(x);y=Number(y);if(this.viewed&&!this.played&&this.options.movable){var changed=!1;if(isNumber(x)){imageData.left=x;changed=!0}
if(isNumber(y)){imageData.top=y;changed=!0}
if(changed){this.renderImage()}}
return this},zoom:function zoom(ratio){var hasTooltip=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;var _originalEvent=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var imageData=this.imageData;ratio=Number(ratio);if(ratio<0){ratio=1/(1-ratio)}else{ratio=1+ratio}
this.zoomTo(imageData.width*ratio/imageData.naturalWidth,hasTooltip,_originalEvent);return this},zoomTo:function zoomTo(ratio){var hasTooltip=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;var _originalEvent=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var _zoomable=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!1;var options=this.options,pointers=this.pointers,imageData=this.imageData;ratio=Math.max(0,ratio);if(isNumber(ratio)&&this.viewed&&!this.played&&(_zoomable||options.zoomable)){if(!_zoomable){var minZoomRatio=Math.max(0.01,options.minZoomRatio);var maxZoomRatio=Math.min(100,options.maxZoomRatio);ratio=Math.min(Math.max(ratio,minZoomRatio),maxZoomRatio)}
if(_originalEvent&&ratio>0.95&&ratio<1.05){ratio=1}
var newWidth=imageData.naturalWidth*ratio;var newHeight=imageData.naturalHeight*ratio;if(_originalEvent){var offset=getOffset(this.viewer);var center=pointers&&Object.keys(pointers).length?getPointersCenter(pointers):{pageX:_originalEvent.pageX,pageY:_originalEvent.pageY};imageData.left-=(newWidth-imageData.width)*((center.pageX-offset.left-imageData.left)/imageData.width);imageData.top-=(newHeight-imageData.height)*((center.pageY-offset.top-imageData.top)/imageData.height)}else{imageData.left-=(newWidth-imageData.width)/2;imageData.top-=(newHeight-imageData.height)/2}
imageData.width=newWidth;imageData.height=newHeight;imageData.ratio=ratio;this.renderImage();if(hasTooltip){this.tooltip()}}
return this},rotate:function rotate(degree){this.rotateTo((this.imageData.rotate||0)+Number(degree));return this},rotateTo:function rotateTo(degree){var imageData=this.imageData;degree=Number(degree);if(isNumber(degree)&&this.viewed&&!this.played&&this.options.rotatable){imageData.rotate=degree;this.renderImage()}
return this},scaleX:function scaleX(_scaleX){this.scale(_scaleX,this.imageData.scaleY);return this},scaleY:function scaleY(_scaleY){this.scale(this.imageData.scaleX,_scaleY);return this},scale:function scale(scaleX){var scaleY=arguments.length>1&&arguments[1]!==undefined?arguments[1]:scaleX;var imageData=this.imageData;scaleX=Number(scaleX);scaleY=Number(scaleY);if(this.viewed&&!this.played&&this.options.scalable){var changed=!1;if(isNumber(scaleX)){imageData.scaleX=scaleX;changed=!0}
if(isNumber(scaleY)){imageData.scaleY=scaleY;changed=!0}
if(changed){this.renderImage()}}
return this},play:function play(){var _this2=this;var fullscreen=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;if(!this.isShown||this.played){return this}
var options=this.options,player=this.player;var onLoad=this.loadImage.bind(this);var list=[];var total=0;var index=0;this.played=!0;this.onLoadWhenPlay=onLoad;if(fullscreen){this.requestFullscreen()}
addClass(player,CLASS_SHOW);forEach(this.items,function(item,i){var img=item.querySelector('img');var image=document.createElement('img');image.src=getData(img,'originalUrl');image.alt=img.getAttribute('alt');total+=1;addClass(image,CLASS_FADE);toggleClass(image,CLASS_TRANSITION,options.transition);if(hasClass(item,CLASS_ACTIVE)){addClass(image,CLASS_IN);index=i}
list.push(image);addListener(image,EVENT_LOAD,onLoad,{once:!0});player.appendChild(image)});if(isNumber(options.interval)&&options.interval>0){var play=function play(){_this2.playing=setTimeout(function(){removeClass(list[index],CLASS_IN);index+=1;index=index<total?index:0;addClass(list[index],CLASS_IN);play()},options.interval)};if(total>1){play()}}
return this},stop:function stop(){var _this3=this;if(!this.played){return this}
var player=this.player;this.played=!1;clearTimeout(this.playing);forEach(player.getElementsByTagName('img'),function(image){removeListener(image,EVENT_LOAD,_this3.onLoadWhenPlay)});removeClass(player,CLASS_SHOW);player.innerHTML='';this.exitFullscreen();return this},full:function full(){var _this4=this;var options=this.options,viewer=this.viewer,image=this.image,list=this.list;if(!this.isShown||this.played||this.fulled||!options.inline){return this}
this.fulled=!0;this.open();addClass(this.button,CLASS_FULLSCREEN_EXIT);if(options.transition){removeClass(list,CLASS_TRANSITION);if(this.viewed){removeClass(image,CLASS_TRANSITION)}}
addClass(viewer,CLASS_FIXED);viewer.setAttribute('style','');setStyle(viewer,{zIndex:options.zIndex});this.initContainer();this.viewerData=assign({},this.containerData);this.renderList();if(this.viewed){this.initImage(function(){_this4.renderImage(function(){if(options.transition){setTimeout(function(){addClass(image,CLASS_TRANSITION);addClass(list,CLASS_TRANSITION)},0)}})})}
return this},exit:function exit(){var _this5=this;var options=this.options,viewer=this.viewer,image=this.image,list=this.list;if(!this.isShown||this.played||!this.fulled||!options.inline){return this}
this.fulled=!1;this.close();removeClass(this.button,CLASS_FULLSCREEN_EXIT);if(options.transition){removeClass(list,CLASS_TRANSITION);if(this.viewed){removeClass(image,CLASS_TRANSITION)}}
removeClass(viewer,CLASS_FIXED);setStyle(viewer,{zIndex:options.zIndexInline});this.viewerData=assign({},this.parentData);this.renderViewer();this.renderList();if(this.viewed){this.initImage(function(){_this5.renderImage(function(){if(options.transition){setTimeout(function(){addClass(image,CLASS_TRANSITION);addClass(list,CLASS_TRANSITION)},0)}})})}
return this},tooltip:function tooltip(){var _this6=this;var options=this.options,tooltipBox=this.tooltipBox,imageData=this.imageData;if(!this.viewed||this.played||!options.tooltip){return this}
tooltipBox.textContent=Math.round(imageData.ratio*100)+'%';if(!this.tooltipping){if(options.transition){if(this.fading){dispatchEvent(tooltipBox,EVENT_TRANSITION_END)}
addClass(tooltipBox,CLASS_SHOW);addClass(tooltipBox,CLASS_FADE);addClass(tooltipBox,CLASS_TRANSITION);tooltipBox.offsetWidth;addClass(tooltipBox,CLASS_IN)}else{addClass(tooltipBox,CLASS_SHOW)}}else{clearTimeout(this.tooltipping)}
this.tooltipping=setTimeout(function(){if(options.transition){addListener(tooltipBox,EVENT_TRANSITION_END,function(){removeClass(tooltipBox,CLASS_SHOW);removeClass(tooltipBox,CLASS_FADE);removeClass(tooltipBox,CLASS_TRANSITION);_this6.fading=!1},{once:!0});removeClass(tooltipBox,CLASS_IN);_this6.fading=!0}else{removeClass(tooltipBox,CLASS_SHOW)}
_this6.tooltipping=!1},1000);return this},toggle:function toggle(){if(this.imageData.ratio===1){this.zoomTo(this.initialImageData.ratio,!0)}else{this.zoomTo(1,!0)}
return this},reset:function reset(){if(this.viewed&&!this.played){this.imageData=assign({},this.initialImageData);this.renderImage()}
return this},update:function update(){var element=this.element,options=this.options,isImg=this.isImg;if(isImg&&!element.parentNode){return this.destroy()}
var images=[];forEach(isImg?[element]:element.querySelectorAll('img'),function(image){if(options.filter){if(options.filter(image)){images.push(image)}}else{images.push(image)}});if(!images.length){return this}
this.images=images;this.length=images.length;if(this.ready){var indexes=[];forEach(this.items,function(item,i){var img=item.querySelector('img');var image=images[i];if(image){if(image.src!==img.src){indexes.push(i)}}else{indexes.push(i)}});setStyle(this.list,{width:'auto'});this.initList();if(this.isShown){if(this.length){if(this.viewed){var index=indexes.indexOf(this.index);if(index>=0){this.viewed=!1;this.view(Math.max(this.index-(index+1),0))}else{addClass(this.items[this.index],CLASS_ACTIVE)}}}else{this.image=null;this.viewed=!1;this.index=0;this.imageData=null;this.canvas.innerHTML='';this.title.innerHTML=''}}}else{this.build()}
return this},destroy:function destroy(){var element=this.element,options=this.options;if(!getData(element,NAMESPACE)){return this}
this.destroyed=!0;if(this.ready){if(this.played){this.stop()}
if(options.inline){if(this.fulled){this.exit()}
this.unbind()}else if(this.isShown){if(this.viewing){if(this.imageRendering){this.imageRendering.abort()}else if(this.imageInitializing){this.imageInitializing.abort()}}
if(this.hiding){this.transitioning.abort()}
this.hidden()}else if(this.showing){this.transitioning.abort();this.hidden()}
this.ready=!1;this.viewer.parentNode.removeChild(this.viewer)}else if(options.inline){if(this.delaying){this.delaying.abort()}else if(this.initializing){this.initializing.abort()}}
if(!options.inline){removeListener(element,EVENT_CLICK,this.onStart)}
removeData(element,NAMESPACE);return this}};var others={open:function open(){var body=this.body;addClass(body,CLASS_OPEN);body.style.paddingRight=this.scrollbarWidth+(parseFloat(this.initialBodyPaddingRight)||0)+'px'},close:function close(){var body=this.body;removeClass(body,CLASS_OPEN);body.style.paddingRight=this.initialBodyPaddingRight},shown:function shown(){var element=this.element,options=this.options;this.fulled=!0;this.isShown=!0;this.render();this.bind();this.showing=!1;if(isFunction(options.shown)){addListener(element,EVENT_SHOWN,options.shown,{once:!0})}
if(dispatchEvent(element,EVENT_SHOWN)===!1){return}
if(this.ready&&this.isShown&&!this.hiding){this.view(this.index)}},hidden:function hidden(){var element=this.element,options=this.options;this.fulled=!1;this.viewed=!1;this.isShown=!1;this.close();this.unbind();addClass(this.viewer,CLASS_HIDE);this.resetList();this.resetImage();this.hiding=!1;if(!this.destroyed){if(isFunction(options.hidden)){addListener(element,EVENT_HIDDEN,options.hidden,{once:!0})}
dispatchEvent(element,EVENT_HIDDEN)}},requestFullscreen:function requestFullscreen(){var document=this.element.ownerDocument;if(this.fulled&&!document.fullscreenElement&&!document.mozFullScreenElement&&!document.webkitFullscreenElement&&!document.msFullscreenElement){var documentElement=document.documentElement;if(documentElement.requestFullscreen){documentElement.requestFullscreen()}else if(documentElement.msRequestFullscreen){documentElement.msRequestFullscreen()}else if(documentElement.mozRequestFullScreen){documentElement.mozRequestFullScreen()}else if(documentElement.webkitRequestFullscreen){documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}}},exitFullscreen:function exitFullscreen(){if(this.fulled){var document=this.element.ownerDocument;if(document.exitFullscreen){document.exitFullscreen()}else if(document.msExitFullscreen){document.msExitFullscreen()}else if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else if(document.webkitExitFullscreen){document.webkitExitFullscreen()}}},change:function change(e){var options=this.options,pointers=this.pointers;var pointer=pointers[Object.keys(pointers)[0]];var offsetX=pointer.endX-pointer.startX;var offsetY=pointer.endY-pointer.startY;switch(this.action){case ACTION_MOVE:this.move(offsetX,offsetY);break;case ACTION_ZOOM:this.zoom(getMaxZoomRatio(pointers),!1,e);break;case ACTION_SWITCH:this.action='switched';this.pointers={};if(Math.abs(offsetX)>Math.abs(offsetY)){if(offsetX>1){this.prev(options.loop)}else if(offsetX<-1){this.next(options.loop)}}
break;default:}
forEach(pointers,function(p){p.startX=p.endX;p.startY=p.endY})},isSwitchable:function isSwitchable(){var imageData=this.imageData,viewerData=this.viewerData;return this.length>1&&imageData.left>=0&&imageData.top>=0&&imageData.width<=viewerData.width&&imageData.height<=viewerData.height}};var AnotherViewer=WINDOW.Viewer;var Viewer=function(){function Viewer(element){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};classCallCheck(this,Viewer);if(!element||element.nodeType!==1){throw new Error('The first argument is required and must be an element.')}
this.element=element;this.options=assign({},DEFAULTS,isPlainObject(options)&&options);this.action=!1;this.fading=!1;this.fulled=!1;this.hiding=!1;this.index=0;this.isImg=!1;this.length=0;this.played=!1;this.playing=!1;this.pointers={};this.ready=!1;this.showing=!1;this.timeout=!1;this.tooltipping=!1;this.viewed=!1;this.viewing=!1;this.isShown=!1;this.wheeling=!1;this.init()}
createClass(Viewer,[{key:'init',value:function init(){var _this=this;var element=this.element,options=this.options;if(getData(element,NAMESPACE)){return}
setData(element,NAMESPACE,this);var isImg=element.tagName.toLowerCase()==='img';var images=[];forEach(isImg?[element]:element.querySelectorAll('img'),function(image){if(isFunction(options.filter)){if(options.filter.call(_this,image)){images.push(image)}}else{images.push(image)}});if(!images.length){return}
this.isImg=isImg;this.length=images.length;this.images=images;var ownerDocument=element.ownerDocument;var body=ownerDocument.body||ownerDocument.documentElement;this.body=body;this.scrollbarWidth=window.innerWidth-ownerDocument.documentElement.clientWidth;this.initialBodyPaddingRight=window.getComputedStyle(body).paddingRight;if(isUndefined(document.createElement(NAMESPACE).style.transition)){options.transition=!1}
if(options.inline){var count=0;var progress=function progress(){count+=1;if(count===_this.length){var timeout=void 0;_this.initializing=!1;_this.delaying={abort:function abort(){clearTimeout(timeout)}};timeout=setTimeout(function(){_this.delaying=!1;_this.build()},0)}};this.initializing={abort:function abort(){forEach(images,function(image){if(!image.complete){removeListener(image,EVENT_LOAD,progress)}})}};forEach(images,function(image){if(image.complete){progress()}else{addListener(image,EVENT_LOAD,progress,{once:!0})}})}else{addListener(element,EVENT_CLICK,this.onStart=function(_ref){var target=_ref.target;if(target.tagName.toLowerCase()==='img'){_this.view(_this.images.indexOf(target))}})}}},{key:'build',value:function build(){if(this.ready){return}
var element=this.element,options=this.options;var parent=element.parentNode;var template=document.createElement('div');template.innerHTML=TEMPLATE;var viewer=template.querySelector('.'+NAMESPACE+'-container');var title=viewer.querySelector('.'+NAMESPACE+'-title');var toolbar=viewer.querySelector('.'+NAMESPACE+'-toolbar');var navbar=viewer.querySelector('.'+NAMESPACE+'-navbar');var button=viewer.querySelector('.'+NAMESPACE+'-button');var canvas=viewer.querySelector('.'+NAMESPACE+'-canvas');this.parent=parent;this.viewer=viewer;this.title=title;this.toolbar=toolbar;this.navbar=navbar;this.button=button;this.canvas=canvas;this.footer=viewer.querySelector('.'+NAMESPACE+'-footer');this.tooltipBox=viewer.querySelector('.'+NAMESPACE+'-tooltip');this.player=viewer.querySelector('.'+NAMESPACE+'-player');this.list=viewer.querySelector('.'+NAMESPACE+'-list');addClass(title,!options.title?CLASS_HIDE:getResponsiveClass(options.title));addClass(navbar,!options.navbar?CLASS_HIDE:getResponsiveClass(options.navbar));toggleClass(button,CLASS_HIDE,!options.button);if(options.backdrop){addClass(viewer,NAMESPACE+'-backdrop');if(!options.inline&&options.backdrop===!0){setData(canvas,'action','hide')}}
if(options.toolbar){var list=document.createElement('ul');var custom=isPlainObject(options.toolbar);var zoomButtons=BUTTONS.slice(0,3);var rotateButtons=BUTTONS.slice(7,9);var scaleButtons=BUTTONS.slice(9);if(!custom){addClass(toolbar,getResponsiveClass(options.toolbar))}
forEach(custom?options.toolbar:BUTTONS,function(value,index){var deep=custom&&isPlainObject(value);var name=custom?hyphenate(index):value;var show=deep&&!isUndefined(value.show)?value.show:value;if(!show||!options.zoomable&&zoomButtons.indexOf(name)!==-1||!options.rotatable&&rotateButtons.indexOf(name)!==-1||!options.scalable&&scaleButtons.indexOf(name)!==-1){return}
var size=deep&&!isUndefined(value.size)?value.size:value;var click=deep&&!isUndefined(value.click)?value.click:value;var item=document.createElement('li');item.setAttribute('role','button');addClass(item,NAMESPACE+'-'+name);if(!isFunction(click)){setData(item,'action',name)}
if(isNumber(show)){addClass(item,getResponsiveClass(show))}
if(['small','large'].indexOf(size)!==-1){addClass(item,NAMESPACE+'-'+size)}else if(name==='play'){addClass(item,NAMESPACE+'-large')}
if(isFunction(click)){addListener(item,EVENT_CLICK,click)}
list.appendChild(item)});toolbar.appendChild(list)}else{addClass(toolbar,CLASS_HIDE)}
if(!options.rotatable){var rotates=toolbar.querySelectorAll('li[class*="rotate"]');addClass(rotates,CLASS_INVISIBLE);forEach(rotates,function(rotate){toolbar.appendChild(rotate)})}
if(options.inline){addClass(button,CLASS_FULLSCREEN);setStyle(viewer,{zIndex:options.zIndexInline});if(window.getComputedStyle(parent).position==='static'){setStyle(parent,{position:'relative'})}
parent.insertBefore(viewer,element.nextSibling)}else{addClass(button,CLASS_CLOSE);addClass(viewer,CLASS_FIXED);addClass(viewer,CLASS_FADE);addClass(viewer,CLASS_HIDE);setStyle(viewer,{zIndex:options.zIndex});var container=options.container;if(isString(container)){container=element.ownerDocument.querySelector(container)}
if(!container){container=this.body}
container.appendChild(viewer)}
if(options.inline){this.render();this.bind();this.isShown=!0}
this.ready=!0;if(isFunction(options.ready)){addListener(element,EVENT_READY,options.ready,{once:!0})}
if(dispatchEvent(element,EVENT_READY)===!1){this.ready=!1;return}
if(this.ready&&options.inline){this.view()}}}],[{key:'noConflict',value:function noConflict(){window.Viewer=AnotherViewer;return Viewer}},{key:'setDefaults',value:function setDefaults(options){assign(DEFAULTS,isPlainObject(options)&&options)}}]);return Viewer}();assign(Viewer.prototype,render,events,handlers,methods,others);if($.fn){var AnotherViewer$1=$.fn.viewer;var NAMESPACE$1='viewer';$.fn.viewer=function jQueryViewer(option){for(var _len=arguments.length,args=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key]}
var result=void 0;this.each(function(i,element){var $element=$(element);var isDestroy=option==='destroy';var viewer=$element.data(NAMESPACE$1);if(!viewer){if(isDestroy){return}
var options=$.extend({},$element.data(),$.isPlainObject(option)&&option);viewer=new Viewer(element,options);$element.data(NAMESPACE$1,viewer)}
if(typeof option==='string'){var fn=viewer[option];if($.isFunction(fn)){result=fn.apply(viewer,args);if(result===viewer){result=undefined}
if(isDestroy){$element.removeData(NAMESPACE$1)}}}});return result!==undefined?result:this};$.fn.viewer.Constructor=Viewer;$.fn.viewer.setDefaults=Viewer.setDefaults;$.fn.viewer.noConflict=function noConflict(){$.fn.viewer=AnotherViewer$1;return this}}})));